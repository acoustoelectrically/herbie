#lang racket
(require math/bigfloat)
(require "../src/rival.rkt" "../src/syntax/types.rkt" "../src/programs.rkt" "../src/load-plugin.rkt" "../src/syntax/sugar.rkt")

(define (cmp-mix-flat pt)
  (define mix-res (parameterize ([bf-precision 128]) (apply my-mix-spec pt)))
  (define flat-res (parameterize ([bf-precision 2048]) (apply my-flat-spec pt)))
  (ival-fl-cmp (ival->list-flo mix-res) (ival->list-flo flat-res)))
  
(define (ival->list-flo iv)
  (let ([lo (ival-lo iv)] [hi (ival-hi iv)])
    (let ([lo* (bigfloat->flonum lo)] [hi* (bigfloat->flonum hi)])
      (list lo* hi*))))
(define (ival-fl-cmp x y)
  (and (equal? (car x) (car y)) (equal? (cdr x) (cdr y))))


(load-herbie-builtins)
(*context* (make-debug-context '(R lambda1 lambda2 phi1 phi2 t0 t1 t2 t3)))

(define (munge s) (compile-prog (desugar-program s (*context*)) 'ival (*context*)))

(define spec '(let* ((t_0 (sin (/ (- lambda1 lambda2) 2.0)))
                     (t_1
                      (+
                       (pow (sin (/ (- phi1 phi2) 2.0)) 2.0)
                       (* (* (* (cos phi1) (cos phi2)) t_0) t_0))))
                (* R (* 2.0 (atan2 (sqrt t_1) (sqrt (- 1.0 t_1)))))))

(define spec-t0 (munge '(/ (- lambda1 lambda2) 2)))
(define spec-t1 (munge '(/ (- phi1 phi2) 2)))
(define spec-t2 (munge 'phi1))
(define spec-t3 (munge 'phi2))
(define spec-final (munge '(let ([t_1 (+ (pow (sin t1) 2) (* (* (* (cos t2) (cos t3)) (sin t0)) (sin t0)))])
                             (* R (* 2 (atan2 (sqrt t_1) (sqrt (- 1 t_1))))))))

(define spec-full (munge spec))
(define (my-flat-spec R l1 l2 p1 p2) (spec-full R l1 l2 p1 p2 0.0 0.0 0.0 0.0))

(define (my-mix-spec R lambda1 lambda2 phi1 phi2)
  (define-values (t0 t1 t2 t3)
    (parameterize ([bf-precision 2048])
      (values (spec-t0 R lambda1 lambda2 phi1 phi2 0.0 0.0 0.0 0.0)
              (spec-t1 R lambda1 lambda2 phi1 phi2 0.0 0.0 0.0 0.0)
              (spec-t2 R lambda1 lambda2 phi1 phi2 0.0 0.0 0.0 0.0)
              (spec-t3 R lambda1 lambda2 phi1 phi2 0.0 0.0 0.0 0.0))))
  (spec-final R lambda1 lambda2 phi1 phi2 t0 t1 t2 t3))



(define mix-res (parameterize ([bf-precision 128]) (my-mix-spec 1.5148727071816122e+119 -6.103796982496031e-293 -2.4222013529441442e+143 1.0861686035675708e+89 -6.151714847176003e+104)))
(define flat-res (parameterize ([bf-precision 2048]) (my-flat-spec 1.5148727071816122e+119 -6.103796982496031e-293 -2.4222013529441442e+143 1.0861686035675708e+89 -6.151714847176003e+104)))

(ival-fl-cmp (ival->list-flo mix-res) (ival->list-flo flat-res))
(ival->list-flo mix-res)
(ival->list-flo flat-res)

(define pts (list 
             (list 1.6132456380310258e-28 7.597533753247529e-211 1.7620537549025395e+217 -1.2218973350081748e+237 -9.115725174627436e+247) 
             (list 2.626737069007574e-149 -7.0943969652355075e-149 -1.0847477141733415e+210 -2.0748844429894502e-24 -1.906140034713355e-239) 
             (list 2.7186434212787423e+284 -9.96492838225324e+99 -5.0708499913255925e+165 -4.283292031115826e+259 2.3023431161981358e-23) 
             (list 2.545854377972735e-160 -2.7941281189559054e-61 1.0119408933175314e+279 6.916280143644877e+249 1.5017604440229712e+274) 
             (list 4.682270088448795e+66 -4.269817024225278e+116 1.1065784417301163e-177 3.220171398812792e+187 -3.955319735787153e+123) 
             (list -8.03749712042929e-258 -1.4113121901154933e+28 6.635410818286703e+216 -2.425719123450652e-168 1.4614017290151725e-183) 
             (list 6.5473693422178206e+283 1.3415813437855054e-195 -6.3580654661368e+243 2.5613623429298807e-219 -1.4524231894307749e+95) 
             (list -1.6494134280208138e+152 3.3926837436087334e-28 -1.5770432895195844e-214 6.488870889293748e+237 1.2200695394115096e-117) 
             (list -2.448039921003914e+197 -1.490306563303837e+251 -3.7248789023084123e+25 -3.9679061676837185e-299 4.3435858853158337e-94) 
             (list 3.3626598765613964e-12 7.594488337836757e-22 5.0012291648584854e+278 -7.368994032934389e-240 1.2949093343206336e+64) 
             (list -33656062720610532.0 -4.765496036701413e+259 2.755579202435957e-40 -3.050851241184272e+35 9.431070273720667e-39) 
             (list -1.0287284529662144e-156 1881.7279558228315 3.826582617488059e+235 3.05097729250559e-87 -4.370676241750161e+81) 
             (list 2.7380010236670605e+85 -9.036972672725066e+62 -2.565787203073175e-79 -2.9517179833982302e+197 8.874397619711168e-180) 
             (list 1.2130805504535875e+193 -4.65520111764299e-269 -1.2473309367565114e+295 -4.2155370439993075e+306 -1.3535370087325834e+26) 
             (list 8.91813988880348e+240 -1.3592431541416935e-75 1.6197431880403697e+204 -2.2263938006899005e-265 5.55176454557844e-118) 
             (list 3.135828059396687e-41 -3.1842835760420867e-143 -1.1250688747978824e+153 -7.957781679525099e+210 7.45481379380469e-56) 
             (list -1.9635675604582952e+99 8.457310064529964e+161 1.0747194256226662e-169 -5.0925370243878e-163 -1.76801502513715e+270) 
             (list -1.9599289222919092e+180 -8.372008030766212e-95 1.1772150300766523e-48 -2.869893852138822e-49 -7.252193820592853e+305) 
             (list -1.8624315605713597e+254 1.7273585862727392e-155 -8.01272422650421e+244 1.9108389179634752e-264 3.0197689899346045e-245) 
             (list 9.716326464553648e-177 1.733700105436757e+270 -7.767582506375267e+161 -0.00026124106135904496 -2.5214379750659668e+146) 
             (list -1.6607321489899706e-280 8.091610667177775e+154 4.6367839412341995e+62 -2.3949561208154598e+126 -3.8688192853079057e-10) 
             (list -7.193890917969572e-132 -2.1342528540645873e+49 -1.571046805092497e+152 -6.300205375160953e+271 -2.0091970044182848e-191) 
             (list -4.254899550027193e+272 7.718478391003775e-285 -3.547447523161721e+193 2.08833318009824e-175 -2.4159091544428405e-216) 
             (list 1.2047517084019028e+110 2.5418661970514017e-231 -2.4244289843335184e+151 5.287971707018491e+184 8.732095447535446e+161) 
             (list -4.8727332453371836e+238 1.330711932782017e+233 3.60242988654953e+307 1.9615955890734157e-277 -1.7928070162618077e+252) 
             (list 9.337275791700352e-77 -1.0948082334839404e+116 -7.100452490781128e+258 1.8766771275130535e+76 -1.2075005386805685e-234) 
             (list 6.240613278254011e-276 -2.7887113596150363e-235 7.794208639585204e-120 -1.694301487392482e-267 3.875971484922906e+253) 
             (list 1.2957327234771692e+161 -8.748309534983886e-213 -4.472966080987285e-295 -3.9706838142165664e+257 2.423066989699372e+73) 
             (list 7.2326739511506605e+106 1.4281694934692802e+201 -1.2077155325591977e-275 -2.189206226972543e+221 1.5840469127520426e-75) 
             (list 3.191016637326593e-288 5.822055086618588e-59 1.2276460222864201e-15 -1.6640065983893496e-109 3.443945895376732e+227) 
             (list 3.915994966714816e+105 -5.270666903884543e-67 -3.1089491780200717e+265 -6.688820301171794e+233 1.12782922489961e-26) 
             (list -5.149936155532078e+39 4.431429579373256e-294 -1.2398342036758379e+62 1.1514115206923335e+290 4.102663149654274e-257) 
             (list -5.403245443177042e+92 4.025546787690042e-237 -1.405997719883617e-306 6.393459853169082e+192 1.8220624066400097e-150) 
             (list 1.2656567352563731e+60 -6.630877255217229e-61 -2.947898718023603e+230 -1.2517230362775495e-10 1.7959306496841897e+265) 
             (list -7.178998129761889e+77 1.1441909245776824e+160 -3.271527035079079e+169 -8.60516164670303e-292 -1.1462280296405088e+139) 
             (list -1.649024209074381e-202 -1.5570557582708425e+202 1.2985368017222484e-211 -9.044190189322073e-200 -9.308966933083434e+274) 
             (list -2.3685719923136397e-279 9.949480082471403e-203 2.29375948811415e+260 -3.4385573286008723e-102 8.778130478838963e-266) 
             (list 7.373037605988951e-220 -2.1267574614770528e-113 3.5686569637523597e+114 -6.955295986882304e-26 -2.8676052672070268e+187) 
             (list 3.52055925428485e-51 -4.0142364758238795e-108 6.894676948446716e-104 -1.1337789999078474e+289 -3.1428749867200076e+274) 
             (list 3.118580631087162e-86 9.028733132110735e-264 6.65404286517215e+159 -6.529931409597259e+279 3.236833787756226e-17) 
             (list 6.3308807133078486e+268 4.126204680240282e+192 1.4386480653598153e+306 -16128.780674115646 -2.7903923583739675e+305) 
             (list -4.623647765818723e-47 5.9346426835623575e-179 2.7381351246886854e+25 1.5861667078122206e+250 -5.1004802417023374e-108) 
             (list 3.88353115511414e+33 -5.202571842093253e-302 -1.0662348739642981e-170 1.8054078714401798e+126 3.854432012466393e+261) 
             (list 1.2870220254553115e-239 3.703143620769529e+290 1.3782747590395856e+231 -5.7358600015254296e-257 -5.570467083027644e-184) 
             (list -5.531658035744243e+299 4.387609532053881e+225 -7.912103910418583e+254 -2.1200535380730578e-240 5.2099923339989496e+293) 
             (list -6.985119319115101e+167 -4.5295706885813774e-228 4.493508054198358e-201 -1.350922186947304e+143 -5.604350606887484e-197) 
             (list -8.351793428098783e+133 1.4136166901000465e+22 3.5824335092178185e+304 -3.040741868357424e-128 2.0420320159824968e-147) 
             (list 2.784677500435607e-148 -1.532452592154778e-243 -1.5536096062097654e-42 9.402040651540907e+148 1.6938974575343599e-15) 
             (list -1.25318224681859e-214 -5.34276885470897e+83 5.160906732073686e+276 1.6804317998797318e+294 -1.7769505781777447e-101) 
             (list 7.79428065640038e+248 -133474294.87114522 -2.3022794802855555e+254 -1.6429942900235042e-95 4.53408141677397e-228) 
             (list 1.8780701805625e+127 1.2709876003369589e+48 -2.3700252415070733e+177 -1.7710239688594174e-118 -8.775916733807992e-92) 
             (list -3.608175628358411e+95 2.036571684511422e-87 2.3305376744283696e-101 -3.788851861626814e+109 -1.4552719604677474e+231) 
             (list 6.365394980803185e+67 -1.8729815531389522e+307 -7.169303630981035e+275 -7.33242172850468e-188 -1.2334320164759177e+252) 
             (list 9.51273159958093e-157 -2.7254848673796546e+23 1.745293947711116e+161 1.2646832982613044e-102 -6.225215789170909e-291) 
             (list 4.289723506045982e-114 9.281544810987674e+60 1.1663260550470632e+193 2.841070940771326e+50 -6.629795699731651e+168) 
             (list -3.1051027790507745e+105 -3.958401375100954e-309 2.672877314058117e-161 -4.1470051287919185e+169 -2.0705684437346475e+120) 
             (list 9.765513770830663e+48 -2.6167603891966956e+195 1.8504077890386175e-302 1.7269575038436167e-76 -1.3241607265253778e-192) 
             (list 3.965536725841598e-114 2.61247029441479e+229 -5.615065438106504e-6 -4.106470486559681e-298 -6.929226028141915e+162) 
             (list 2.752263570818798e+205 3.921478514274687e-92 6.863394542465519e+75 4.5138895520031026e+195 2.15935832306323e+179) 
             (list 4.2643140555532685e+75 -1.6986608109223783e+264 -9.724385388275769e+160 -7.710072201752715e+96 1.92263469617816e-141) 
             (list -9.165908900166366e-178 1.5882551485033261e+190 -1.1056460636496712e+112 -11297766208.282675 1.14895407115322e-203) 
             (list -1.00555871947513e+72 -1.7364805063464575e-40 -2.0330699871147863e+121 3.471908075829361e+219 1.2341802541416432e-182) 
             (list -2.500877033612918e-253 -8.768509692861258e-296 -2.837167647786617e+167 -1.6171848233860156e-245 -1.0350303350083721e-133) 
             (list -2.159661778031971e+82 3.0394760634254534e+78 -2.6418805739845025e-87 -1.7451106567866426e-78 -2.444129925228884e+244) 
             (list 1.5665755775516476e+216 5.599978525266232e-245 1.3143424451938584e-170 -1.2082555526363825e-173 -2.418901710198747e+157) 
             (list -4.572317046472581e+215 4.511413150285542e-128 -1.7084212193484435e+302 -3.656460510341611e-72 -2.4923966863553706e-205) 
             (list -6.5879466632213425e-105 -1.0853076227674298e-50 2.8686634076034288e+107 -1.736418085139485e+229 -1.7487373642381494e-177) 
             (list -1.2761913449088302e+47 9.361943241750022e-169 2.94487596549741e-94 2.2003470744637607e+132 3.6542574281119294e+278) 
             (list 3.734545550575519e-13 -2.178119761377655e+81 -3.7410547596039283e+33 1.7173915274059037e+189 1.3645733595675574e-6) 
             (list -2.2104400490813328e+196 -5.209999269850254e-259 1.6907197496078986e-134 5.7952961395084264e+29 -1.936867256562206e+270) 
             (list 4.2046022766438437e+303 3.276198274553775e-137 -1.0468697710365023e+273 1.8816711296458055e-110 3.882629216351813e-197) 
             (list 1.2177161306754642e+195 -1.79195702981975e+286 4.67124031916855e+184 -18585611805.05442 -1.7604649497615502e-121) 
             (list 9.821906302909257e+48 -6.2790704550319925e-245 4.140622757526721e-12 -5.187255109884452e+98 -1.606798432322009e+245) 
             (list -3.321780668211335e-144 -3.904752931414603e+65 2.658668213872284e+262 -8.28764876991807e+44 2.336113589191593e-259) 
             (list 1.8746255667644268e-88 3.604456745461651e-212 -2.1973978772763034e+177 3.422533281016432e+87 2.5097734530219694e-308) 
             (list 5.17942637313169e-47 2.1796137106282374e-57 1.0354341225063338e+150 2.8586507062438092e-229 -7.607561897824889e+37) 
             (list 5.649495126817338e-169 4.309899982100552e+145 2.426381257639603e-86 -5.563637826019304e-196 1.6790110083050978e+271) 
             (list -3.081164778296213e-293 -1.3814817241618963e-142 -4.003680083891806e+273 -1.036121093928605e-308 5.432396335871778e+304) 
             (list -8.217463205470776e-197 1.3616611524192117e-289 -5.132945231230854e+206 -3.038275083765415e+217 -1.1554312014966957e-232) 
             (list -2.276591853714863e+115 4.2253140821470917e+176 -3.6175267216766254e+34 3.536449245755801e-254 -9.355620957065076e-79) 
             (list -2.3098902548675746e-274 2.5316274520807413e+187 3.2304654267831328e+44 -8.650239376309388e-127 4.125681665754334e+307) 
             (list 8.396500213424241e+185 -1.2640075271751193e-230 8.245928032639006e-56 7.038282983175607e+45 -4.473263000779891e+175) 
             (list -7.055697546414753e-158 1.711363489782378e+195 7.884885189265381e-39 -1.1282570687643336e+79 -5.358663207727621e+197) 
             (list 5.109716834996196e+73 -8.30878899241525e+261 2.521826886527809e-185 9.699053402888164e+305 -1.7034456225805027e+211) 
             (list -2.5991470455522308e+79 -4.626325483159874e-301 -3.9040500937543994e+45 6.177574411443474e+263 1.0303752593133386e+39) 
             (list -3.6697650792935836e+113 -1.6013883590601031e+60 -6.217562647671224e-90 -1.4448752835616811e-62 1.1606109172535112e+235) 
             (list 5.7805303623892445e+196 -3.366377373903959e-13 3.4128032927964205e+232 1.954520502510725e-219 -8.964904032567789e-38) 
             (list -7.238389029831815e-193 -7.436995796567537e-104 1.1010827838156471e+295 1.4735184735717664e-42 4.537613439722909e-170) 
             (list 6.632249389168671e-114 1461.2776429929047 -3.521976179291758e+180 -5.352978393235631e+251 9.775473005368352e+215) 
             (list 9.684254559455535e+215 6.286598568073254e-271 2.0828483387486475e-203 7.513086306419299e-99 -2.735223483679531e+137) 
             (list -1.8538455070403364e+109 2.673132500758325e+218 -2.192497648749728e-161 10330728728185745000.0 3.910678102530729e-225) 
             (list -4.845744612369881e+111 -2.9019121949379994e+178 2.337381063062346e+92 1.4946225887670731e+259 -3.9246656920073053e+77) 
             (list 3.107480921694783e-192 -2.2494497038214916e+156 -2.1108609038945905e+119 -1.8231333977317105e-270 6.643702631634778e-229) 
             (list -1.9024362270387238e+206 -1.4894521120237065e+146 4.514135108075686e-238 9.575035590143467e+123 2.3150912179601577e+139) 
             (list 1.5446862240942167e+199 4.619941140070045e-169 8.724224908260089e+247 -4.388831627015181e+259 -8.549575177803992e-304) 
             (list 1.0193286650658903e+140 -1.2250800269487045e+144 -5.575017708772272e-14 4.2852516155187345e+195 1.9973091093460728e-163) 
             (list -3.027752451626188e-217 -5.727963934869276e-105 6.325110647773065e-220 3.5200824143360294e-249 -8.633179498479937e+217) 
             (list 1.3690808348348205e-260 1.061995594101154e-116 1.269477494823136e+167 -4.211540427051603e+106 1.8001222695235483e+158) 
             (list 1.3771736891425607e-58 3.79013642304343e-254 3.5959583431949085e-202 -1.7628338450947513e+298 -1.1737295522285958e+222) 
             (list -6.235795584431085e+248 -1.2083847256473822e+88 -1.8651663208980752e+258 7.214044520059604e+246 5.808293917582749e+254) 
             (list -3.621823329067447e+176 4.069338670304463e-241 -3.0704265553529277e+237 2.5494114314276856e-149 -2.453295036577518e-250) 
             (list -8.81482135036723e-147 2.669480579134234e+242 -3.1932704912857773e+264 -3.1992423361029967e-136 1.160379167045863e-234) 
             (list -1.8347968887436731e-283 -5.005310620202952e-15 -2.780499379449378e+222 -2.6831278825322e+175 2.5742981016970523e-142) 
             (list 3.327067964814544e+281 -1.3496712892252217e+23 4.844027225112361e-265 1.204572588422573e+53 3.9110816141757654e+164) 
             (list -1.91587298653928e-150 -4.506535217432602e+72 -4.650373911416447e+172 2.0792766324166496e-11 3.4984512734463024e-263) 
             (list -3.5311098451567803e-278 1.116973329285829e-91 -2.6354878500453248e-189 2.9505710735928125e+182 -1.1149659546874872e-38) 
             (list 4.637748767760225e+276 8.86749556214865e+292 1.5455498385803631e+196 -0.012891326304887056 -7.5693664985928635e+28) 
             (list -7.053651877168234e+94 2.2752693786909598e+250 1.1338925766385952e-293 -1.1026666047236937e+118 -6.925997733019606e-135) 
             (list 9.382877609953105e+165 -4.666714187807172e-189 -6.409997996261191e+162 2.314585889153612e+55 8.963920702726827e-104) 
             (list -1.7165252116526182e+131 -3.6254914895147894e-159 2.5702977799468246e+284 -2.5148309274807733e+131 -1.2604557717599475e+117) 
             (list -2.5731183635353187e-67 -6.547797816989566e+114 -1.7365840849605173e-79 -1.4589578561427026e+35 1.9632598070205813e+291) 
             (list -4.871210686245122e-242 -1.4898840221731854e+81 -1.548129715837351e+280 -1.064699697281315e-240 -9.256235085693665e-256) 
             (list 3.243817392478277e+249 7.67017206008039e-261 -5.794887757441238e+306 2.8143411421631797e-261 -1.3422535552648125e-80) 
             (list 3.292966955020081e+247 -2.446569918678935e-218 -7.952111011021321e-180 1.7989930972620985e+240 8.844571737902784e-226) 
             (list 8.266106105451477e-172 -5.945976249684309e-132 3.6588636265394516e+164 2.0424393016109396e+198 4.809090484390168e+293) 
             (list 7.432277658988311e-170 3.471505891533569e+48 -1.2277459147418344e+263 -2.7001796120764724e+102 -3.781222406510655e-118) 
             (list -4.1555820610591484e+26 1.0324695820425623e-94 8.40835657187637e+206 3.725468488590036e-32 1.0254732751306528e+191) 
             (list 9.402824512610997e-18 0.0013527693968245452 1.073196683561575e-257 2.9505943811790104e+285 -4.1551858478657066e-91) 
             (list 6.822606285741141e+167 -3.680156932880082e+83 3.5762665190875276e+295 -7.118057320553533e+61 -2.37885004413644e+187) 
             (list -4.509081485843728e+227 1.062262854634207e+96 6.581837218878357e+245 5.5261629645100405e+96 7.530835031868418e-103) 
             (list 6.93321751301824e+147 1120121.1387696487 -1.5269048410643525e+304 -6.723325278069106e+162 -4.5313664637495755e-269) 
             (list 1.0208134090300476e+26 -7.513357261246663e+129 8.480848232396671e+21 -6.849237755354535e+240 -7.408941687405545e+267) 
             (list -8.598089235817064e-270 5.1844336300017495e-37 11454061.08624111 -3.296196281184227e+107 1.1403067052405632e+163) 
             (list -6.332671111675404e-200 5.691595508308587e+298 -9.229163978184984e+235 1.0817191514078483e-26 -1.501696349419815e-107) 
             (list 7.253038298314623e-170 -7.668010207017186e+202 -3.306641073620122e-230 -3.8142459223512727e-221 -4.006526761844512e-35) 
             (list -1.0783627781957927e+158 9.116589477918223e+300 -1.1337432124723289e-235 -5.894617308228161e-199 -2.0854157384971715e-77) 
             (list -6.25564917116972e+128 -2.0221569853118894e-303 4.9491417835949574e-278 -2.832923228031263e+29 -5.4931857900740635e+231) 
             (list -0.01280002342659789 7.308628684342663e-87 1.1680036841241664e-278 -1.1412387546420098e-265 -3.973385454474694e+199) 
             (list -1.437751727851924e+160 -1.3724279877753865e-187 4.4965076710088637e+279 -4.629691737996801e-104 3.218911369005946e+118) 
             (list 4.3066567360116773e+142 -5.84619107682486e-250 -2.4897165398361503e+278 -2.8834010243204222e-303 -2.05432241830593e-227) 
             (list -4.4071340708452826e-55 2.263511759868496e+77 6.634739074788532e-93 4.526819958279339e+284 4.478645659784999e+53) 
             (list -3.2206729225427266e-54 -9.021031147508769e+242 -5.830524199587711e-286 -5.256597133593254e+199 -8.97913906929503e+53) 
             (list 1.4376259589758315e-128 5.5785367218005405e-65 1.1044112619131534e-258 3.961502622214256e+173 -3.8248524177978573e+84) 
             (list -3.577271014708199e-7 9.918496668294927e+290 9.148096262884538e-280 -4.788943161675844e-34 -1.188337873075478e+90) 
             (list 8.637929375724459e-211 2.5727906601588893e+145 -5.523993709461277e-192 -1.3921923290537248e-68 4.09064877326004e+51) 
             (list -3.0893808829166304e-276 7.32177718983038e+58 1.3441434449718506e-181 -1.8891930248076784e-53 1.5735814585582407e+158) 
             (list 2.2545704915898502e+27 7.899350825942412e-74 4.210028799114889e-44 -1.8782872749497994e+282 1.5627175448761525e+184) 
             (list 1.477740056927438e+107 -8.183752028645708e-63 3.007496610663723e+126 -9.309831747939894e-221 1.295138611668268e+295) 
             (list 1.4489628442322046e-73 5.215270882622226e-173 -6.230301622517005e+148 1.629514189112635e-231 -7.574311916375619e-100) 
             (list 1.6996690503905729e+44 2.489848585321337e+208 1.7401090208175824e-72 2.325621508830134e-198 2.44891776118771e+98) 
             (list -6.52142992416265e-214 -6.454404456954452e+211 -2.6603426823974313e+204 6.380773293980908e-221 363515749182163800.0) 
             (list -1.4185711732956767e+94 3.436141440316466e-85 9.23739704277492e-299 -7.40994726410416e+125 1.912013534072674e+248) 
             (list 1.0988179408127613e+132 -1.3439928227617447e+199 1.6938241677086024e-220 -1.3641847014250223e+110 7.627790153198197e+185) 
             (list 7.811663609718881e+62 -5.131636212035437e+139 -1.3429068688639626e-300 2.1126908924330004e-290 1.567232180251104e-46) 
             (list 2.81912145428908e+86 1.8711038917878744e-20 -3.506145014194455e+198 -5.111794823996142e+70 -6.817504837708493e-291) 
             (list 1.7207955312683594e-186 7.172292674207612e+250 4.655570023597276e+305 -3.8123472975731527e+229 4.833343090929297e+238) 
             (list 1.428375479488637e+33 4.967733072349334e+235 2.1518137069025654e+164 6.82930316037442e-51 1.1544737826668647e-165) 
             (list -3.1213034937269127e-149 1.2960530312900038e+243 -1.1308123622812112e+24 -8.944882128306336e-65 -1.5650337523008102e+102) 
             (list -4.9306979113472007e+92 1.1125309490464125e-42 1.0143560922316355e-53 1.9504312161045666e-90 -7.645079412261566e+274) 
             (list 7.484480304436614e+116 4.1779115637139115e+186 1.5229610921096685e-60 3.632263123444594e+19 2.244553604753393e-110) 
             (list -6.594250107546971e+155 -1.657227190390262e+133 5.226892594021481e+282 -1.123607893464026e+121 -1.7427090994673842e-295) 
             (list -1.4850031532509825e+214 1.1002854602544839e-38 -1.4682219471012313e-284 2.8258329024008612e+286 -6.014851565736591e+152) 
             (list 7.153862684798196e-155 -5.7758875754464873e+79 -46434770334210.04 -1.770150824977372e+246 3.8064730006529526e-87) 
             (list -6.296555791756044e-137 -4.7921185623727827e-194 -8.130528368712512e+233 -3.483062771755584e+239 1.2319133264307519e-256) 
             (list 5.288272353136244e-275 1.2335579734057622e+178 -2.027715085755475e+20 3.0190231670273416e-62 -4.910225255873504e+57) 
             (list 1.3267746972743663e+198 4.140512125939653e+291 -2.9990864311168796e-256 5.810679127356831e-151 -9.400457489285752e+114) 
             (list -4.5887576508565537e+291 -1.2538692135826505e+197 -6.095246877125199e-302 4.22953479663203e+105 -4.896002147531663e-299) 
             (list -4.5182608883621554e+228 -1.0836748945059753e-109 -3.2912027151518765e-32 -9.528170775360195e-115 -3.6722828954829587e+202)))
  
(map cmp-mix-flat pts)